<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard Router - Online Attendance</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1>Redirecting to your dashboard...</h1>
    <nav>
      <a href="index.html">Login</a>
      <a href="dashboard.html" class="active">Dashboard</a>
      <a href="students.html">Students</a>
      <a href="attendance.html">Attendance</a>
      <a href="reports.html">Reports</a>
    </nav>
  </header>
  <main>
    <section class="card">
      <p id="routerMessage">Detecting your role and opening the correct dashboard.</p>
    </section>
  </main>

  <script>
    function getAuth() {
      try {
        const raw = localStorage.getItem('auth');
        return raw ? JSON.parse(raw) : null;
      } catch (e) {
        return null;
      }
    }

    (function routeByRole() {
      const auth = getAuth();
      const messageEl = document.getElementById('routerMessage');

      if (!auth || !auth.user || !auth.token) {
        messageEl.textContent = 'You are not logged in. Redirecting to login...';
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 600);
        return;
      }

      const role = auth.user.role;
      if (role === 'admin') {
        window.location.href = 'admin-dashboard.html';
      } else if (role === 'teacher') {
        window.location.href = 'teacher-dashboard.html';
      } else if (role === 'student') {
        window.location.href = 'student-dashboard.html';
      } else {
        messageEl.textContent = 'Unknown role. Redirecting to login...';
        localStorage.removeItem('auth');
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 800);
      }
    })();
  </script>
</body>
</html>
